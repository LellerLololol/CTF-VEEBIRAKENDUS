{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import'../App.css';import Header from'../components/header';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function getCookie(name){const value=\"; \".concat(document.cookie);const parts=value.split(\"; \".concat(name,\"=\"));if(parts.length===2)return parts.pop().split(';').shift();return null;}function Admin(){const[isAuthenticated,setIsAuthenticated]=useState(false);const[loading,setLoading]=useState(true);const textareaRef=useRef(null);useEffect(()=>{const checkToken=async()=>{const token=getCookie('token');if(token){try{const response=await fetch('/api/is_admin',{method:'POST',headers:{'Content-Type':'application/json'}});if(response.ok){const data=await response.json();if(data.flag){setFlag(data.flag);}getJWT();setIsAuthenticated(true);}else{setIsAuthenticated(false);}}catch(error){console.error('Error validating token',error);setIsAuthenticated(false);}}else{setIsAuthenticated(false);}setLoading(false);};checkToken();},[]);async function getJWT(){const response=await fetch('/api/getAllOffers',{method:'GET',headers:{'Content-Type':'application/json'}});const message=await response.json();var a={};a.target=textareaRef.current;textareaRef.current.value=JSON.stringify(message,null,2);takeSize(a);}function takeSize(e){var el=e.target;setTimeout(function(){el.style.cssText='min-height:37px; height: 37px; width: 90%; background-color: #FCFCE4';// for box-sizing other than \"content-box\" use:\n// el.style.cssText = '-moz-box-sizing:content-box';\nel.style.cssText='height:'+el.scrollHeight+'px; width: 90%; background-color: #F9ECC9';},0);}if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Checking for admin status...\"});}if(!isAuthenticated){return/*#__PURE__*/_jsx(\"div\",{children:\"Page denied. You are not admin\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"Admin\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"scrollable\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Amazing, you truly are the admin of this page!\"}),flag&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Your Flag: \",flag]}),\" \"]}),/*#__PURE__*/_jsx(\"textarea\",{onChange:e=>{takeSize(e);},ref:textareaRef}),/*#__PURE__*/_jsx(\"button\",{onClick:async e=>{const message=e.target.value;const response=await fetch('/api/updateData.json',{method:'POST',body:{\"message\":message},headers:{'Content-Type':'application/json'}});},style:{margin:'5px',width:'400px',height:'200px',fontSize:'32px'},children:\"Update data.json\"})]})]});}export default Admin;","map":{"version":3,"names":["React","useState","useEffect","useRef","Header","jsx","_jsx","jsxs","_jsxs","getCookie","name","value","concat","document","cookie","parts","split","length","pop","shift","Admin","isAuthenticated","setIsAuthenticated","loading","setLoading","textareaRef","checkToken","token","response","fetch","method","headers","ok","data","json","flag","setFlag","getJWT","error","console","message","a","target","current","JSON","stringify","takeSize","e","el","setTimeout","style","cssText","scrollHeight","children","className","onChange","ref","onClick","body","margin","width","height","fontSize"],"sources":["C:/Users/Mike/Code/CTF-VEEBIRAKENDUS/client/src/pages/admin.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport '../App.css';\r\nimport Header from '../components/header';\r\n\r\nfunction getCookie(name) {\r\n\tconst value = `; ${document.cookie}`;\r\n\tconst parts = value.split(`; ${name}=`);\r\n\tif (parts.length === 2) return parts.pop().split(';').shift();\r\n\treturn null;\r\n}\r\n\r\nfunction Admin() {\r\n\tconst [isAuthenticated, setIsAuthenticated] = useState(false);\r\n\tconst [loading, setLoading] = useState(true);\r\n\r\n\tconst textareaRef = useRef(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tconst checkToken = async () => {\r\n\t\t\tconst token = getCookie('token');\r\n\r\n\t\t\tif (token) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst response = await fetch('/api/is_admin', {\r\n\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (response.ok) {\r\n\t\t\t\t\t\tconst data = await response.json();\r\n\t\t\t\t\t\tif (data.flag) {\r\n\t\t\t\t\t\t\tsetFlag(data.flag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgetJWT()\r\n\t\t\t\t\t\tsetIsAuthenticated(true);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetIsAuthenticated(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('Error validating token', error);\r\n\t\t\t\t\tsetIsAuthenticated(false);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsetIsAuthenticated(false);\r\n\t\t\t}\r\n\r\n\t\t\tsetLoading(false);\r\n\t\t};\r\n\r\n\t\tcheckToken();\r\n\t}, []);\r\n\r\n\tasync function getJWT() {\r\n\t\tconst response = await fetch('/api/getAllOffers', {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tconst message = await response.json()\r\n\t\tvar a = {}\r\n\t\ta.target = textareaRef.current\r\n\t\ttextareaRef.current.value = JSON.stringify(message, null, 2)\r\n\t\ttakeSize(a)\r\n\t}\r\n\r\n\tfunction takeSize(e) {\r\n\t\tvar el = e.target;\r\n\t\tsetTimeout(function () {\r\n\t\t\tel.style.cssText = 'min-height:37px; height: 37px; width: 90%; background-color: #FCFCE4';\r\n\t\t\t// for box-sizing other than \"content-box\" use:\r\n\t\t\t// el.style.cssText = '-moz-box-sizing:content-box';\r\n\t\t\tel.style.cssText = 'height:' + el.scrollHeight + 'px; width: 90%; background-color: #F9ECC9';\r\n\t\t}, 0);\r\n\t}\r\n\r\n\tif (loading) {\r\n\t\treturn <div>Checking for admin status...</div>;\r\n\t}\r\n\r\n\tif (!isAuthenticated) {\r\n\t\treturn <div>Page denied. You are not admin</div>;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"Admin\">\r\n\t\t\t<Header />\r\n\t\t\t<div className='scrollable'>\r\n\t\t\t\t<h1>Amazing, you truly are the admin of this page!</h1>\r\n\r\n\t\t\t\t{/* Display the flag if it's available */}\r\n\t\t\t\t{flag && (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h2>Your Flag: {flag}</h2> {/* Display the flag here */}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<textarea onChange={(e) => {\r\n\t\t\t\t\ttakeSize(e)\r\n\t\t\t\t}} ref={textareaRef}></textarea>\r\n\t\t\t\t<button onClick={async (e) => {\r\n\r\n\t\t\t\t\tconst message = e.target.value\r\n\r\n\t\t\t\t\tconst response = await fetch('/api/updateData.json', {\r\n\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\tbody: {\"message\": message},\r\n\t\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\t\t\t\t}} style={{margin: '5px', width: '400px', height: '200px', fontSize: '32px'}}>Update data.json</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default Admin;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}